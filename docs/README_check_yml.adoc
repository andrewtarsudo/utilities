= Руководство для check_yml.py
:experimental:
:icons: font
:source-highlighter: rouge
:imagesdir: images
:figure-caption: Рисунок
:stylesdir: ../css
:stylesheet: default.css
:nofooter:
:toc: auto
:toc-title: Содержание

== Описание

Скрипт проверяет все пути по порядку в файле `PDF_*.yml`.

В результате отображается информация, найден ли текстовый файл по указанному пути в формате:

[,log]
----
<line no> <path to file> ...... <OK/NOT OK>
----

* `line no` -- номер строки в исходном файле;
* `path to file` -- текст строки;
* `OK/NOT OK` -- флаг существования файла по указанному пути.

include::partials/check_yml_sample.adoc[]

Поскольку в выводе много строк, то для удобства ориентирования в нем используется интуитивная цветовая индикация.

CAUTION: Скрипт не показывает, где именно ошибка, это остается делом пользователя, а указывает лишь на сам факт ее существования.

== Для чего нужно?

Изначально скрипт написан для проверки файла `PDF_*.yml`, необходимого для генерации PDF. +
Ввиду того, что генерация PDF осуществляется целой партией, bundle, то ошибка с одним проектом ведет к отбою обновления всех других.

== Как запустить?

Запускается так же, как и любые другие скрипты:

[source,shell]
----
$ py <path/to/check_yml.py> <OPTIONS> // <1> <2>
----

<1> path/to/check_yml.py -- путь до скрипта `check_yml.py`
<2> OPTIONS -- опции скрипта

=== Опции скрипта

NOTE: Здесь предполагается, что скрипт находится в директории, откуда запускается, +
т.е. `<path/to/check_yml.py>` -> `check_yml.py`.

[source,console]
----
Использование: py check_yml.py [ -h/--help | -v/--version ] YAML_FILE [ -o/--output OUTPUT ]

Валидация YAML-файла для PDF

Обязательные параметры:
  yaml_file             Путь до файла PDF_*.yml

Опциональные:
  -o OUTPUT, --output OUTPUT
                        Файл для записи вывода
  -v, --version         Показать версию скрипта и завершить работу
  -h, --help            Показать справку и завершить работу
----

=== Как использовать?

NOTE: Хотя `YAML_FILE` является обязательным параметром, его можно опустить, если файл скрипта находится в той же директории, что и YAML-файл.

Если файл не указан, то сначала проверяется директория со скриптом на наличие файла `PDF_*.yml`.
Если таковой найден, то начинается его обработка.
Если такового нет, то будет запрошен путь у пользователя.

Поэтому предлагается следующее решение как самое простое:

. Загрузить скрипт по https://gitlab.com/tech_writers_protei/scripts/-/raw/main/scripts/check_yml.py?inline=false[ссылке].
. Перенести его в ту же директорию, где находятся все проекты `PycharmProjects` или `IdeaProjects`.
+
NOTE: Как правило, это директория `С:\Users\<login>\`.
+
. При необходимости проверить YAML-файл в проекте, воспользоваться встроенной консолью IDE.
+
.Иконка консоли
image::find_console.png[align="center",width=960]
+
.Консоль в IDE
image::console_ide.png[align="center",width=960]
+
. Перейти в корень проекта, если текущее местоположение от него отличается, с помощью команды `cd`.
. В консоли указать команду `py ..\check_yml.py`.

При желании записи в файл команда изменится на `py ..\check_yml.py -o "<file_name>.log"` +
или `py ..\check_yml.py --output="<file_name>.log"`.

TIP: Чтобы удобно и быстро получить путь до файла, можно выполнить следующие шаги:

include::partials/get_path.adoc[]