[[convert-tables]]
= Руководство для convert-tables
:imagesdir: images
:stylesdir: ../css
:stylesheet: default.css
:pdf-themesdir: themes
:pdf-theme: base-theme.yml
:script-name: convert-tables
:asciidoctorconfigdir: ..

== Описание

Скрипт извлекает из файла Word формата *.docx или *.docm все таблицы и преобразует их в формат Markdown.
Каждая таблица записывается в отдельный файл под тем же номером, что и в исходном файле.

== Для чего нужно?

При использовании `pandoc`, самого распространенного программного обеспечения для конвертации файлов, таблицы в некоторых случаях обрабатываются некорректно.
Например, если заголовок многоуровневый; содержит текст, расположенный на нескольких строках и др. возможные случаи.

include::partials/run.adoc[]

=== Опции скрипта

[source,console,subs="attributes+"]
----
Использование:
{name} {script-name} <DOCX_FILE>
-p/--parse DIR_TABLES | -t/--temp TEMP_DIR | -e/--escape | -r/--remove | -f/--fix | -k/--keep |
--keep-logs | --h/--help

  Команда для корректного извлечения таблиц из файлов docx в формат Markdown

Аргументы:
  docx_file                              Путь до файла Word в формате *.docx или *.docm

Опции:
  -p, --parse DIR_TABLES                 Директория для таблиц. По умолчанию: ./tables/.
                                         Если не существует, то будет создана
  -t, --temp TEMP_DIR                    Временная директория. По умолчанию: ./_temp/.
                                         Если не существует, то будет создана
  -e, --escape / --no-escape             Флаг экранирования символов '<', '>'.
                                         По умолчанию: True, добавление '\' перед символами
  -r, --remove / --no-remove             Флаг удаления всех множественных пробелов и пробелов
                                         перед знаками препинания.
                                         По умолчанию: True, удаление всех лишних пробелов
  -f, --fix / --no-fix                   Флаг удаления лишних пробелов и экранирования символов.
                                         По умолчанию: не задано, определяется параметрами
                                         --escape и --remove.
                                         Приоритет выше, чем у опций --escape и --remove.
                                         Примечание. Не может использоваться одновременно с
                                         --keep
  -k, --keep / --no-keep                 Флаг извлечения текста без дополнительной обработки.
                                         По умолчанию: не задано, определяется параметрами
                                         --escape и --remove.
                                         Приоритет выше, чем у опций --escape и --remove.
                                         Примечание. Не может использоваться одновременно с
                                         --fix
  {keep-logs}
                                         {keep-logs-cont}
                                         {keep-logs-default}
  {help}
                                         {help-cont}
-------------------------------------------------------------------------------------------------
----

NOTE: Путь может быть как абсолютным, так и относительным.

=== Примеры

include::partials/convert-tables.adoc[]