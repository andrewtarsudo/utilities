[[convert-tables]]
= Руководство для convert-tables
:experimental:
:icons: font
:source-highlighter: rouge
:imagesdir: images
:figure-caption: Рисунок
:stylesdir: ../css
:stylesheet: default.css
:nofooter:
:toc: auto
:toc-title: Содержание
:sectnums:
:pdf-themesdir: themes
:pdf-theme: base-theme.yml
:name: tw_utilities.exe
:script-name: convert-tables

== Описание

Скрипт извлекает из файла Word формата *.docx или *.docm все таблицы и преобразует их в формат Markdown.
Каждая таблица записывается в отдельный файл под тем же номером, что и в исходном файле.

== Для чего нужно?

При использовании `pandoc`, самого распространенного программного обеспечения для конвертации файлов, таблицы в некоторых случаях обрабатываются некорректно.
Например, если заголовок многоуровневый; содержит текст, расположенный на нескольких строках и др. возможные случаи.

include::partials/run.adoc[]

=== Опции скрипта

[source,console,subs="attributes+"]
----
Использование:
{name} {script-name} <DOCX_FILE>
-p/--parse <DIR TABLES> | -t/--temp <TEMP DIR> | -e/--escape | -r/--remove | -f/--fix | -k/--keep |
--keep-logs | --h/--help

  Команда для корректного извлечения таблиц из файлов docx в формат Markdown

Аргументы:
  docx_file                              Путь до файла Word в формате *.docx или *.docm

Опции:
  -p, --parse <DIR TABLES>               Директория для хранения таблиц. По умолчанию: ./tables/.
                                         Если не существует, то будет создана
  -t, --temp <TEMP DIR>                  Временная директория для скрипта. По умолчанию: ./_temp/.
                                         Если не существует, то будет создана
  -e, --escape / --no-escape             Флаг экранирования символов '<', '>'.
                                         По умолчанию: True, добавление '\' перед символами
  -r, --remove / --no-remove             Флаг удаления всех множественных пробелов и пробелов
                                         перед знаками препинания.
                                         По умолчанию: True, удаление всех дополнительных пробелов
  -f, --fix / --no-fix                   Флаг удаления лишних пробелов и экранирования символов.
                                         По умолчанию: не задано, обработка определяется параметрами
                                         --preserve и --escape.
                                         Имеет приоритет выше, чем у опций --preserve и --escape.
                                         Примечание. Аргумент не может использоваться одновременно с
                                         --keep
  -k, --keep / --no-keep                 Флаг извлечения текста без дополнительной обработки.
                                         По умолчанию: не задано, обработка определяется параметрами
                                         --preserve и --escape.
                                         Имеет приоритет выше, чем у опций --preserve и --escape.
                                         Примечание. Аргумент не может использоваться одновременно с
                                         --fix
  --keep-logs                            Флаг сохранения директории с лог-файлом по завершении
                                         работы в штатном режиме.
                                         По умолчанию: False, лог-файл и директория удаляются
  -h, --help                             Вывести справочную информацию на экран и завершить работу
----------------------------------------------------------------------------------------------------
----

NOTE: Путь может быть как абсолютным, так и относительным.
